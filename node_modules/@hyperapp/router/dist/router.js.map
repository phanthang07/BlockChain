{"version":3,"sources":["dist/router.js"],"names":["global","factory","exports","module","require","define","amd","hyperappRouter","hyperapp","this","getOrigin","loc","protocol","hostname","port","createMatch","isExact","path","url","params","trimTrailingSlash","len","length","slice","decodeParam","val","decodeURIComponent","e","location$1","state","pathname","window","location","previous","actions","go","history","pushState","set","data","subscribe","handleLocationChange","detail","unwrap","keys","reduce","next","key","fn","title","call","dispatchEvent","CustomEvent","wrapHistory","addEventListener","removeEventListener","Link","props","children","to","onclick","href","defaultPrevented","button","altKey","metaKey","ctrlKey","shiftKey","target","anchorElement","isExternal","currentTarget","preventDefault","h","Route","match","options","exact","paths","split","urls","i","parseRoute","parent","render","Switch","child","Redirect","replaceState","from"],"mappings":"CAAC,SAAUA,EAAQC,GACE,iBAAZC,SAA0C,oBAAXC,OAAyBF,EAAQC,QAASE,QAAQ,aACtE,mBAAXC,QAAyBA,OAAOC,IAAMD,OAAO,CAAC,UAAW,YAAaJ,GAC5EA,EAASD,EAAOO,eAAiB,GAAIP,EAAOQ,UAH/C,CAIEC,KAAM,SAAWP,EAAQM,GAAY,aAErC,SAASE,EAAUC,GACjB,OAAOA,EAAIC,SAAW,KAAOD,EAAIE,UAAYF,EAAIG,KAAO,IAAMH,EAAIG,KAAO,IA6C3E,SAASC,EAAYC,EAASC,EAAMC,EAAKC,GACvC,MAAO,CACLH,QAASA,EACTC,KAAMA,EACNC,IAAKA,EACLC,OAAQA,GAIZ,SAASC,EAAkBF,GACzB,IAAK,IAAIG,EAAMH,EAAII,OAAQ,MAAQJ,IAAMG,KACzC,OAAOH,EAAIK,MAAM,EAAGF,EAAM,GAG5B,SAASG,EAAYC,GACnB,IACE,OAAOC,mBAAmBD,GAC1B,MAAOE,GACP,OAAOF,GAkFX,IAAIG,EAAa,CACfC,MAAO,CACLC,SAAUC,OAAOC,SAASF,SAC1BG,SAAUF,OAAOC,SAASF,UAE5BI,QAAS,CACPC,GAAI,SAASL,GACXM,QAAQC,UAAU,KAAM,GAAIP,IAE9BQ,IAAK,SAASC,GACZ,OAAOA,IAGXC,UAAW,SAASN,GAClB,SAASO,EAAqBd,GAC5BO,EAAQI,IAAI,CACVR,SAAUC,OAAOC,SAASF,SAC1BG,SAAUN,EAAEe,OACPX,OAAOC,SAASC,SAAWN,EAAEe,OAC9BX,OAAOC,SAASC,WAIxB,IAAIU,EAvCR,SAAqBC,GACnB,OAAOA,EAAKC,OAAO,SAASC,EAAMC,GAChC,IAAIC,EAAKZ,QAAQW,GAOjB,OALAX,QAAQW,GAAO,SAASR,EAAMU,EAAO/B,GACnC8B,EAAGE,KAAKzC,KAAM8B,EAAMU,EAAO/B,GAC3BiC,cAAc,IAAIC,YAAY,YAAa,CAAEV,OAAQH,MAGhD,WACLH,QAAQW,GAAOC,EACfF,GAAQA,MAET,MA0BYO,CAAY,CAAC,YAAa,iBAKvC,OAHAC,iBAAiB,YAAab,GAC9Ba,iBAAiB,WAAYb,GAEtB,WACLc,oBAAoB,YAAad,GACjCc,oBAAoB,WAAYd,GAChCE,OAKNzC,EAAQsD,KA5KR,SAAcC,EAAOC,GACnB,OAAO,SAAS7B,EAAOK,GACrB,IAAIyB,EAAKF,EAAME,GACX3B,EAAWH,EAAMG,SACjB4B,EAAUH,EAAMG,QA4BpB,cA3BOH,EAAME,UACNF,EAAMzB,SAEbyB,EAAMI,KAAOF,EACbF,EAAMG,QAAU,SAASjC,GACnBiC,GACFA,EAAQjC,GAGRA,EAAEmC,kBACW,IAAbnC,EAAEoC,QACFpC,EAAEqC,QACFrC,EAAEsC,SACFtC,EAAEuC,SACFvC,EAAEwC,UACe,WAAjBV,EAAMW,QA1Bd,SAAoBC,GAGlB,OAAO3D,EAAUsB,YAActB,EAAU2D,GAwBnCC,CAAW3C,EAAE4C,iBAGb5C,EAAE6C,iBAEEb,IAAO3B,EAASF,UAClBM,QAAQC,UAAUL,EAASF,SAAU,GAAI6B,KAKxCnD,EAASiE,EAAE,IAAKhB,EAAOC,KA6IlCxD,EAAQwE,MA1FR,SAAejB,GACb,OAAO,SAAS5B,EAAOK,GACrB,IAAIF,EAAWH,EAAMG,SACjB2C,EA5BR,SAAoB1D,EAAMC,EAAK0D,GAC7B,GAAI3D,IAASC,IAAQD,EACnB,OAAOF,EAAYE,IAASC,EAAKD,EAAMC,GAGzC,IAAI2D,EAAQD,GAAWA,EAAQC,MAC3BC,EAAQ1D,EAAkBH,GAAM8D,MAAM,KACtCC,EAAO5D,EAAkBF,GAAK6D,MAAM,KAExC,KAAID,EAAMxD,OAAS0D,EAAK1D,QAAWuD,GAASC,EAAMxD,OAAS0D,EAAK1D,QAAhE,CAIK,IAAI2D,EAAI,EAAG9D,EAAS,GAAIE,EAAMyD,EAAMxD,OAAzC,IAAiDJ,EAAM,GAAI+D,EAAI5D,EAAK4D,IAAK,CACvE,GAAI,MAAQH,EAAMG,GAAG,GACnB9D,EAAO2D,EAAMG,GAAG1D,MAAM,IAAMyD,EAAKC,GAAKzD,EAAYwD,EAAKC,SAClD,GAAIH,EAAMG,KAAOD,EAAKC,GAC3B,OAEF/D,GAAO8D,EAAKC,GAAK,IAGnB,OAAOlE,GAAY,EAAOE,EAAMC,EAAIK,MAAM,GAAI,GAAIJ,IAMpC+D,CAAWzB,EAAMxC,KAAMe,EAASF,SAAU,CACpD+C,OAAQpB,EAAM0B,SAGhB,OACER,GACAlB,EAAM2B,OAAO,CACXT,MAAOA,EACP3C,SAAUA,MAgFlB9B,EAAQmF,OA1ER,SAAgB5B,EAAOC,GACrB,OAAO,SAAS7B,EAAOK,GAGrB,IAFA,IAAIoD,EACFL,EAAI,IAEFK,EAAQ5B,EAASuB,IAAMvB,EAASuB,GAAGpD,EAAOK,KAC5C+C,EAAIvB,EAASpC,QAEb2D,IACF,OAAOK,IAkEXpF,EAAQqF,SA9DR,SAAkB9B,GAChB,OAAO,SAAS5B,EAAOK,GACrB,IAAIF,EAAWH,EAAMG,SACrBI,QAAQoD,aAAa/B,EAAMgC,MAAQzD,EAASF,SAAU,GAAI2B,EAAME,MA4DpEzD,EAAQ8B,SAAWJ","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('hyperapp')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'hyperapp'], factory) :\n  (factory((global.hyperappRouter = {}),global.hyperapp));\n}(this, (function (exports,hyperapp) { 'use strict';\n\n  function getOrigin(loc) {\n    return loc.protocol + \"//\" + loc.hostname + (loc.port ? \":\" + loc.port : \"\")\n  }\n\n  function isExternal(anchorElement) {\n    // Location.origin and HTMLAnchorElement.origin are not\n    // supported by IE and Safari.\n    return getOrigin(location) !== getOrigin(anchorElement)\n  }\n\n  function Link(props, children) {\n    return function(state, actions) {\n      var to = props.to;\n      var location = state.location;\n      var onclick = props.onclick;\n      delete props.to;\n      delete props.location;\n\n      props.href = to;\n      props.onclick = function(e) {\n        if (onclick) {\n          onclick(e);\n        }\n        if (\n          e.defaultPrevented ||\n          e.button !== 0 ||\n          e.altKey ||\n          e.metaKey ||\n          e.ctrlKey ||\n          e.shiftKey ||\n          props.target === \"_blank\" ||\n          isExternal(e.currentTarget)\n        ) {\n        } else {\n          e.preventDefault();\n\n          if (to !== location.pathname) {\n            history.pushState(location.pathname, \"\", to);\n          }\n        }\n      };\n\n      return hyperapp.h(\"a\", props, children)\n    }\n  }\n\n  function createMatch(isExact, path, url, params) {\n    return {\n      isExact: isExact,\n      path: path,\n      url: url,\n      params: params\n    }\n  }\n\n  function trimTrailingSlash(url) {\n    for (var len = url.length; \"/\" === url[--len]; );\n    return url.slice(0, len + 1)\n  }\n\n  function decodeParam(val) {\n    try {\n      return decodeURIComponent(val)\n    } catch (e) {\n      return val\n    }\n  }\n\n  function parseRoute(path, url, options) {\n    if (path === url || !path) {\n      return createMatch(path === url, path, url)\n    }\n\n    var exact = options && options.exact;\n    var paths = trimTrailingSlash(path).split(\"/\");\n    var urls = trimTrailingSlash(url).split(\"/\");\n\n    if (paths.length > urls.length || (exact && paths.length < urls.length)) {\n      return\n    }\n\n    for (var i = 0, params = {}, len = paths.length, url = \"\"; i < len; i++) {\n      if (\":\" === paths[i][0]) {\n        params[paths[i].slice(1)] = urls[i] = decodeParam(urls[i]);\n      } else if (paths[i] !== urls[i]) {\n        return\n      }\n      url += urls[i] + \"/\";\n    }\n\n    return createMatch(false, path, url.slice(0, -1), params)\n  }\n\n  function Route(props) {\n    return function(state, actions) {\n      var location = state.location;\n      var match = parseRoute(props.path, location.pathname, {\n        exact: !props.parent\n      });\n\n      return (\n        match &&\n        props.render({\n          match: match,\n          location: location\n        })\n      )\n    }\n  }\n\n  function Switch(props, children) {\n    return function(state, actions) {\n      var child,\n        i = 0;\n      while (\n        !(child = children[i] && children[i](state, actions)) &&\n        i < children.length\n      )\n        i++;\n      return child\n    }\n  }\n\n  function Redirect(props) {\n    return function(state, actions) {\n      var location = state.location;\n      history.replaceState(props.from || location.pathname, \"\", props.to);\n    }\n  }\n\n  function wrapHistory(keys) {\n    return keys.reduce(function(next, key) {\n      var fn = history[key];\n\n      history[key] = function(data, title, url) {\n        fn.call(this, data, title, url);\n        dispatchEvent(new CustomEvent(\"pushstate\", { detail: data }));\n      };\n\n      return function() {\n        history[key] = fn;\n        next && next();\n      }\n    }, null)\n  }\n\n  var location$1 = {\n    state: {\n      pathname: window.location.pathname,\n      previous: window.location.pathname\n    },\n    actions: {\n      go: function(pathname) {\n        history.pushState(null, \"\", pathname);\n      },\n      set: function(data) {\n        return data\n      }\n    },\n    subscribe: function(actions) {\n      function handleLocationChange(e) {\n        actions.set({\n          pathname: window.location.pathname,\n          previous: e.detail\n            ? (window.location.previous = e.detail)\n            : window.location.previous\n        });\n      }\n\n      var unwrap = wrapHistory([\"pushState\", \"replaceState\"]);\n\n      addEventListener(\"pushstate\", handleLocationChange);\n      addEventListener(\"popstate\", handleLocationChange);\n\n      return function() {\n        removeEventListener(\"pushstate\", handleLocationChange);\n        removeEventListener(\"popstate\", handleLocationChange);\n        unwrap();\n      }\n    }\n  };\n\n  exports.Link = Link;\n  exports.Route = Route;\n  exports.Switch = Switch;\n  exports.Redirect = Redirect;\n  exports.location = location$1;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=router.js.map\n"]}